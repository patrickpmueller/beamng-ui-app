<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<?xml-stylesheet href="app.css" type="text/css"?><!-- Created with Inkscape (http://www.inkscape.org/) -->

<!-- Or (\ui\modules\apps\Forcedinductionanimated\image.gif) if you want to embed an image into the mod folder (search key image1) -->

<!-- Perhaps your changed location will be changed after the update, take care of your files in advance! -->

<link rel="stylesheet" href="app.css">
<svg
   viewBox="0 0 660 660"
   id="svg2"
   version="1.1"
   inkscape:version="0.91 r13725"
   sodipodi:docname="forcedinductionanimated.svg"
   inkscape:export-filename="forcedinductionanimated.svg"
   inkscape:export-xdpi="181.33821"
   inkscape:export-ydpi="181.33821"
   xml:space="preserve"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns:xlink="http://www.w3.org/1999/xlink"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:dc="http://purl.org/dc/elements/1.1/"><defs
     id="defs4"><style
       type="text/css"
       id="style4">
@font-face {
  font-family: Open Sans Bold;
  src: url(/ui/common/OpenSans-Bold.ttf);
}
@font-face {
  font-family: Open Sans;
  src: url(/ui/common/OpenSans-Regular.ttf);
}
@font-face {
  font-family: Open Sans Extrabold;
  src: url(/ui/common/OpenSans-ExtraBold.ttf);
}
@font-face {
  font-family: Squada One;
  src: url(/ui/common/SquadaOne-Regular.ttf);
}

    </style><radialGradient
       inkscape:collect="always"
       xlink:href="#linearGradient4357-0"
       id="radialGradient4363-4"
       cx="480"
       cy="544"
       fx="480"
       fy="544"
       r="320"
       gradientUnits="userSpaceOnUse"
       gradientTransform="matrix(1.03125,0,0,1.03125,-15,-17)" /><linearGradient
       id="linearGradient4357-0"><stop
         style="stop-color:#000000;stop-opacity:0.65178573;"
         offset="0"
         id="stop4359-9" /><stop
         style="stop-color:#000000;stop-opacity:0.24107143;"
         offset="1"
         id="stop4361-4" /></linearGradient><linearGradient
       id="linearGradient4365-4"><stop
         style="stop-color:#000000;stop-opacity:0.42857143;"
         offset="0"
         id="stop4367-5" /><stop
         id="stop4373-5"
         offset="0.5"
         style="stop-color:#000000;stop-opacity:0.33035713;" /><stop
         style="stop-color:#000000;stop-opacity:0;"
         offset="1"
         id="stop4369-1" /></linearGradient><radialGradient
       r="320"
       fy="544"
       fx="480"
       cy="544"
       cx="480"
       gradientUnits="userSpaceOnUse"
       id="radialGradient3997"
       xlink:href="#linearGradient4365-4"
       inkscape:collect="always" /><clipPath
       clipPathUnits="userSpaceOnUse"
       id="clipPath3653"><path
         style="color:#000000;display:inline;overflow:visible;visibility:visible;fill:#ffffff;fill-opacity:0.613757;fill-rule:nonzero;stroke:none;stroke-width:16;marker:none;enable-background:accumulate"
         d="M 480,84 C 225.94901,84 20,289.94901 20,544 20,798.05099 225.94901,1004 480,1004 734.05099,1004 940,798.05099 940,544 940,289.94901 734.05099,84 480,84 Z m 0,322 c 76.21531,0 138,61.78469 138,138 0,76.21531 -61.78469,138 -138,138 -76.21531,0 -138,-61.78469 -138,-138 0,-76.21531 61.78469,-138 138,-138 z"
         id="path3655"
         inkscape:connector-curvature="0" /></clipPath><clipPath
       clipPathUnits="userSpaceOnUse"
       id="clipPath4490"><path
         style="color:#000000;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:medium;line-height:normal;font-family:sans-serif;text-indent:0;text-align:start;text-decoration:none;text-decoration-line:none;text-decoration-style:solid;text-decoration-color:#000000;letter-spacing:normal;word-spacing:normal;text-transform:none;writing-mode:lr-tb;direction:ltr;baseline-shift:baseline;text-anchor:start;white-space:normal;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:96.9109;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate"
         d="m 330,10 c -176.15718,3e-6 -319.999997,143.84282 -320,320 0,88.07859 35.961054,168.07824 93.94141,226.05859 l 68.0957,-68.0957 C 131.73748,447.66326 106.91016,391.89131 106.91016,330 c 0,-123.78262 99.30722,-223.08984 223.08984,-223.08984 123.78262,0 223.08984,99.30722 223.08984,223.08984 0,61.89131 -24.82732,117.66326 -65.12695,157.96289 l 68.0957,68.0957 C 614.03895,498.07824 650,418.07859 650,330 650,153.84282 506.15718,10 330,10 Z"
         id="path4492"
         inkscape:connector-curvature="0" /></clipPath><clipPath
       clipPathUnits="userSpaceOnUse"
       id="clipPath4494"><path
         style="color:#000000;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:medium;line-height:normal;font-family:sans-serif;text-indent:0;text-align:start;text-decoration:none;text-decoration-line:none;text-decoration-style:solid;text-decoration-color:#000000;letter-spacing:normal;word-spacing:normal;text-transform:none;writing-mode:lr-tb;direction:ltr;baseline-shift:baseline;text-anchor:start;white-space:normal;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:96.9109;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate"
         d="m 330,10 c -176.15718,3e-6 -319.999997,143.84282 -320,320 0,88.07859 35.961054,168.07824 93.94141,226.05859 l 68.0957,-68.0957 C 131.73748,447.66326 106.91016,391.89131 106.91016,330 c 0,-123.78262 99.30722,-223.08984 223.08984,-223.08984 123.78262,0 223.08984,99.30722 223.08984,223.08984 0,61.89131 -24.82732,117.66326 -65.12695,157.96289 l 68.0957,68.0957 C 614.03895,498.07824 650,418.07859 650,330 650,153.84282 506.15718,10 330,10 Z"
         id="path4496"
         inkscape:connector-curvature="0" /></clipPath><clipPath
       clipPathUnits="userSpaceOnUse"
       id="clipPath4498"><path
         style="color:#000000;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:medium;line-height:normal;font-family:sans-serif;text-indent:0;text-align:start;text-decoration:none;text-decoration-line:none;text-decoration-style:solid;text-decoration-color:#000000;letter-spacing:normal;word-spacing:normal;text-transform:none;writing-mode:lr-tb;direction:ltr;baseline-shift:baseline;text-anchor:start;white-space:normal;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:96.9109;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate"
         d="m 240.41631,-226.27417 c -124.56194,124.56194 -124.56194,327.9864 0,452.54834 62.28096,62.28097 144.27756,93.42096 226.27417,93.42095 v -96.30186 c -56.99229,0 -113.98458,-21.88116 -157.74834,-65.64492 -87.52753,-87.527531 -87.52753,-227.969149 0,-315.49668 87.52753,-87.52753 227.96915,-87.52753 315.49668,0 C 668.20258,-113.98457 690.08374,-56.992283 690.08374,0 h 96.30186 c 1e-5,-81.996605 -31.13998,-163.9932 -93.42095,-226.27417 -124.56194,-124.56194 -327.98641,-124.56194 -452.54834,0 z"
         id="path4500"
         inkscape:connector-curvature="0" /></clipPath><clipPath
       clipPathUnits="userSpaceOnUse"
       id="clipPath2"><ellipse
         style="display:inline;fill:#000000;stroke-width:1.40097"
         id="ellipse2"
         cx="329.66812"
         cy="330.81284"
         rx="328.52347"
         ry="327.37878" /></clipPath><radialGradient
       inkscape:collect="always"
       xlink:href="#linearGradient4357-0"
       id="radialGradient4363-4-8"
       cx="480"
       cy="544"
       fx="480"
       fy="544"
       r="320"
       gradientUnits="userSpaceOnUse"
       gradientTransform="matrix(1.03125,0,0,1.03125,-15,-17)" /><clipPath
       clipPathUnits="userSpaceOnUse"
       id="clipPath2-3"><ellipse
         style="display:inline;fill:#000000;stroke-width:1.40097"
         id="ellipse2-5"
         cx="329.66812"
         cy="330.81284"
         rx="328.52347"
         ry="327.37878" /></clipPath><radialGradient
       inkscape:collect="always"
       xlink:href="#linearGradient4357-0"
       id="radialGradient1"
       gradientUnits="userSpaceOnUse"
       gradientTransform="matrix(1.03125,0,0,1.03125,-15,-17)"
       cx="480"
       cy="544"
       fx="480"
       fy="544"
       r="320" /></defs><sodipodi:namedview
     id="base"
     pagecolor="#ffffff"
     bordercolor="#666666"
     borderopacity="1.0"
     inkscape:pageopacity="0.0"
     inkscape:pageshadow="2"
     inkscape:zoom="0.87360575"
     inkscape:cx="285.47065"
     inkscape:cy="370.02554"
     inkscape:document-units="px"
     inkscape:current-layer="layer6"
     showgrid="true"
     inkscape:window-width="1642"
     inkscape:window-height="768"
     inkscape:window-x="74"
     inkscape:window-y="91"
     inkscape:window-maximized="0"
     fit-margin-top="0"
     fit-margin-left="0"
     fit-margin-right="0"
     fit-margin-bottom="0"
     showguides="false"
     inkscape:guide-bbox="true"
     inkscape:snap-to-guides="true"
     inkscape:snap-grids="true"
     inkscape:snap-bbox="true"
     inkscape:bbox-nodes="true"
     inkscape:bbox-paths="true"
     inkscape:snap-bbox-edge-midpoints="true"
     inkscape:snap-bbox-midpoints="true"
     inkscape:snap-center="true"
     inkscape:snap-object-midpoints="true"
     inkscape:snap-page="true"
     inkscape:showpageshadow="2"
     inkscape:pagecheckerboard="0"
     inkscape:deskcolor="#d1d1d1"><inkscape:grid
       type="xygrid"
       id="grid3954"
       empspacing="5"
       visible="true"
       enabled="true"
       snapvisiblegridlinesonly="true"
       originx="-150"
       originy="-149.7917"
       spacingy="1"
       spacingx="1"
       units="px" /></sodipodi:namedview><metadata
     id="metadata7"><rdf:RDF><cc:Work
         rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title /></cc:Work></rdf:RDF></metadata><g
     inkscape:label="background"
     inkscape:groupmode="layer"
     id="layer1"
     transform="translate(-150,-242.15388)"
     style="display:none;opacity:1"><rect
       style="fill:#505050;fill-opacity:1;stroke:none"
       id="rect4616"
       width="2175.3789"
       height="1458.4727"
       x="-727.47485"
       y="-115.47279" /></g><g
     inkscape:groupmode="layer"
     id="layer6"
     inkscape:label="new"
     style="display:inline"
     transform="translate(0,0.20830138)"><image
       width="654.82135"
       height="655.966"
       preserveAspectRatio="none"
       xlink:href="/settings/forcedinduction/image2.gif"
       id="image2"
       x="2.2575052"
       y="1.6851641"
       style="display:inline;overflow:visible;visibility:visible;fill:url(#radialGradient4363-4-8);fill-opacity:1"
       clip-path="url(#clipPath2-3)"
       inkscape:label="image2"
       transform="matrix(1.0074293,0,0,1.0078736,-2.207246,-2.9557807)"
       inkscape:svg-dpi="1" /><circle
       style="color:#000000;display:inline;overflow:visible;visibility:visible;fill:url(#radialGradient3997);fill-opacity:1;fill-rule:nonzero;stroke:none;stroke-width:16;marker:none;enable-background:accumulate"
       id="path4281-5"
       cx="480"
       cy="544"
       r="320"
       transform="translate(-150,-214)" /><path
       style="color:#000000;display:inline;overflow:visible;visibility:visible;fill:url(#radialGradient4363-4);fill-opacity:1;fill-rule:nonzero;stroke:none;stroke-width:6;marker:none;enable-background:accumulate"
       d="M 480,214 C 297.74603,214 150,361.74603 150,544 150,726.25397 297.74603,874 480,874 662.25397,874 810,726.25397 810,544 810,361.74603 662.25397,214 480,214 Z"
       id="path4281"
       inkscape:connector-curvature="0"
       sodipodi:nodetypes="sssss"
       clip-path="url(#clipPath3653)"
       transform="translate(-150,-214)" /><image
       width="654.82135"
       height="655.966"
       preserveAspectRatio="none"
       xlink:href="/settings/forcedinduction/image.gif"
       id="image1"
       x="2.2575052"
       y="1.6851641"
       style="display:inline;overflow:visible;visibility:visible;fill:url(#radialGradient1);fill-opacity:1"
       clip-path="url(#clipPath2)"
       inkscape:label="image1"
       transform="matrix(1.0074165,0,0,1.0089699,-2.0402722,-3.673156)" /><text
       xml:space="preserve"
       class="pressure-Text"
       x="329.85437"
       y="328.48807"
       id="tspan4449-43"
       inkscape:label="#pressureText"><tspan
         sodipodi:role="line"
         id="pressureText"
         x="329.85437"
         y="328.48807"
         class="pressureText">0</tspan></text><text
       xml:space="preserve"
       class="text-style"
       x="329.03198"
       y="413.62915"
       id="speed_units"
       inkscape:label="#speed_units"
       inkscape:transform-center-y="-4.486084"><tspan
         sodipodi:role="line"
         id="pressureunit"
         x="329.03198"
         y="413.62915"
         class="speed-units">PSI</tspan></text><text
       xml:space="preserve"
       class="text-style"
       x="165.89227"
       y="187.39682"
       id="pressuretext4p"><tspan
         sodipodi:role="line"
         id="pressuretext4"
         x="165.89227"
         y="187.39682"
         class="tspan-style">4</tspan></text><text
       xml:space="preserve"
       class="text-style"
       x="284.48657"
       y="123.71478"
       id="pressuretext5p"><tspan
         sodipodi:role="line"
         id="pressuretext5"
         x="284.48657"
         y="123.71478"
         class="tspan-style">5</tspan></text><text
       xml:space="preserve"
       class="text-style"
       x="419.43579"
       y="137.55835"
       id="pressuretext6p"><tspan
         sodipodi:role="line"
         id="pressuretext6"
         x="419.43579"
         y="137.55835"
         class="tspan-style">6</tspan></text><text
       xml:space="preserve"
       class="text-style"
       x="110.04411"
       y="303.35791"
       id="pressuretext3p"><tspan
         sodipodi:role="line"
         id="pressuretext3"
         x="110.04411"
         y="303.35791"
         class="tspan-style">3</tspan></text><text
       xml:space="preserve"
       class="text-style"
       x="124.71793"
       y="434.92328"
       id="pressuretext2p"><tspan
         sodipodi:role="line"
         id="pressuretext2"
         x="124.71793"
         y="434.92328"
         class="tspan-style">2</tspan></text><text
       xml:space="preserve"
       class="text-style"
       x="197.49423"
       y="531.5639"
       id="pressuretext1p"><tspan
         sodipodi:role="line"
         id="pressuretext1"
         x="197.49423"
         y="531.5639"
         class="tspan-style">1</tspan></text><text
       xml:space="preserve"
       class="text-style"
       x="520.0791"
       y="228.94992"
       id="pressuretext7p"><tspan
         sodipodi:role="line"
         id="pressuretext7"
         x="520.0791"
         y="228.94992"
         class="tspan-style">7</tspan></text><text
       xml:space="preserve"
       class="text-style"
       x="520.0791"
       y="228.94992"
       id="pressuretext8p"><tspan
         sodipodi:role="line"
         id="pressuretext8"
         x="520.0791"
         y="228.94992"
         class="tspan-style">8</tspan></text><text
       xml:space="preserve"
       class="text-style"
       x="520.0791"
       y="228.94992"
       id="pressuretext9p"><tspan
         sodipodi:role="line"
         id="pressuretext9"
         x="520.0791"
         y="228.94992"
         class="tspan-style">9</tspan></text><text
       xml:space="preserve"
       class="text-style"
       x="520.0791"
       y="228.94992"
       id="pressuretext10p"><tspan
         sodipodi:role="line"
         id="pressuretext10"
         x="520.0791"
         y="228.94992"
         class="tspan-style">10</tspan></text></g><g
     inkscape:groupmode="layer"
     id="layer3"
     inkscape:label="FIX"
     style="display:inline"
     transform="translate(0,0.20830138)"><g
       id="revcurvemask"
       clip-path="url(#clipPath4710)"
       style="display:inline"><rect
         style="color:#000000;display:inline;overflow:visible;visibility:visible;fill:#000000;fill-opacity:0.37037;fill-rule:nonzero;stroke:none;stroke-width:16;marker:none;enable-background:accumulate"
         id="rect4001"
         width="683.79401"
         height="683.79401"
         x="127.97179"
         y="-340.09323"
         transform="rotate(45)"
         clip-path="url(#clipPath4498)" /><path
         style="color:#000000;display:inline;overflow:visible;visibility:visible;fill:none;stroke:#ffffff;stroke-width:99.3103;stroke-miterlimit:4;stroke-dasharray:2374.27, 2374.27;stroke-dashoffset:0;stroke-opacity:1;marker:none;enable-background:accumulate"
         d="M 147.9957,528.59996 C 50,420 27.118653,298.1594 119.95323,156.00847 150,110 350,-30 532.60856,149.71493 c 74.5117,73.33098 97.08931,264.86379 -10.87668,369.15745"
         id="pressureCurve"
         inkscape:connector-curvature="0"
         clip-path="url(#clipPath4494)"
         sodipodi:nodetypes="cssc" /><path
         style="color:#000000;overflow:visible;visibility:visible;fill:none;stroke:#9c0000;stroke-width:117.918;stroke-linecap:butt;stroke-linejoin:bevel;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:604.648;stroke-opacity:0.661376;marker:none;enable-background:accumulate"
         d="M 147.99571,510.41274 C 33.434043,395.42128 59.279735,242.76116 138.14044,153.71911 230,50 387.77546,50.913502 485.67663,112.95746 c 165.77018,105.05531 132.03401,312.46382 37.32761,407.0596"
         id="pressure_redline"
         clip-path="url(#clipPath4490)"
         inkscape:connector-curvature="0"
         sodipodi:nodetypes="cssc" /></g></g><g
     inkscape:groupmode="layer"
     id="layer11"
     inkscape:label="revs"
     style="display:inline"
     transform="translate(0,0.20830138)"><path
       style="display:inline;fill:none;stroke:#000000;stroke-width:96.911;stroke-miterlimit:0.4;stroke-dasharray:48.4555, 48.4555;stroke-dashoffset:0;stroke-opacity:0.375661"
       d="m 137.9887,522.0113 c -106.044908,-106.04491 -106.044903,-277.97769 1e-5,-384.0226 106.04491,-106.044917 277.97767,-106.044914 384.02259,0 106.04491,106.04491 106.04492,277.97769 10e-6,384.0226"
       id="pressureCurve_dashes"
       inkscape:connector-curvature="0"
       sodipodi:nodetypes="cssc"
       inkscape:label="#path4531-4" /><path
       style="display:inline;fill:none;stroke:#e90000;stroke-width:2.86352;stroke-miterlimit:0.4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:0.244048"
       d="m 202.03513,457.96488 c -70.12576,-70.12575 -70.12576,-183.82209 0,-253.94784 70.12575,-70.12576 183.82208,-70.12576 253.94784,0 70.12575,70.12575 70.12575,183.82209 0,253.94784"
       id="pressuretextline"
       inkscape:connector-curvature="0"
       sodipodi:nodetypes="cssc"
       inkscape:label="#path4531-4" /></g><g
     inkscape:groupmode="layer"
     id="layer7"
     inkscape:label="new2"
     style="display:inline"
     transform="translate(0,0.20830138)"><g
       id="pressure_needle_d"
       inkscape:label="#g4147"
       transform="translate(-1.2852971e-6)"><rect
         y="7.0002151"
         x="322.0993"
         height="103.00317"
         width="12.038266"
         id="rect4625"
         style="color:#000000;display:inline;overflow:visible;visibility:visible;fill:#d70000;fill-opacity:1;fill-rule:nonzero;stroke:none;stroke-width:67.389;marker:none;enable-background:accumulate"
         transform="matrix(1,0,0.00784004,0.99996927,0,0)" /><rect
         transform="scale(1,-1)"
         y="-660"
         x="322.44037"
         height="660"
         width="15.11928"
         id="rect4625-1"
         style="color:#000000;display:inline;overflow:visible;visibility:visible;fill:#008000;fill-opacity:0;fill-rule:nonzero;stroke:none;stroke-width:67.389;marker:none;enable-background:accumulate" /></g></g><script
     type="text/javascript"
     id="script159">

document.getStreams = function() {
  return ['forcedInductionInfo'];
};

var width  = 660;
var height = 660;
var initialized = false;
var pressure_redline_len = 0;
var dashSize = 5;

// pressure
var pressureText = document.getElementById('pressureText');
pressureText.textContent = '';

// pressureCurve
var pressureCurve = document.getElementById('pressureCurve');
var pressureCurveLen = pressureCurve.getTotalLength();
pressureCurve.style['stroke-dasharray'] = pressureCurveLen + ' ' + pressureCurveLen;

// pressureCurve dashes
var pressureCurveDashes = document.getElementById('pressureCurve_dashes');
var pressureCurveDashesLen = pressureCurveDashes.getTotalLength();

// redline
var redLine = document.getElementById('pressure_redline');
var redLineLen = redLine.getTotalLength();

// pressureTextGuideLine -- a helping line to position the text
var pressureTextGuideLine = document.getElementById('pressuretextline');
var pressureTextGuideLineLen = pressureTextGuideLine.getTotalLength();
pressureTextGuideLine.style['display'] = 'none';

// the pressure text
var pressureTextSize = 50; // in px
var dashCount = 5;

// setup + hide all
for(var k = 1; k &lt; dashCount + 3; k++) {
  document.getElementById('pressuretext' + k).style['visibility'] = 'hidden';
  document.getElementById('pressuretext' + k).style['font-size'] = pressureTextSize + 'px';
}
var PRESURE_MAX_CONST = 150;
var PRESURE_MIN_CONST = -100;
var pressure_max;
var pressure_min;
//dashCount = 3; // this can artifically limit the number of rpm splits

// pressure_needle
var pressure_needle = document.getElementById('pressure_needle_d');
var pressureunitText = document.getElementById('pressureunit');


var displayMode = 2;

function applyData(data) {
  var boost = UnitPressure(data.boost);

  pressureText.textContent = document.roundDec(boost, 1);

  // (boost % of scala) / (displayed range)
  var percPos = (boost - pressure_min) / (pressure_max - pressure_min);

  // just in case the boost has inconsistent data
  if (percPos &lt; 0) {
    percPos = 0;
  }
  if (percPos &gt; 1) {
    percPos = 1;
  }

  // % of scala * scala deg
  // orig transform is vertical so -135 to &quot;move&quot; 0 to start of curve
  pressure_needle.setAttribute('transform','rotate(' + (percPos * 270 - 135) + ',' + (width / 2) + ',' + (height / 2) + ')');

  // 0 offset means the whole thing is filled white. pressureCurveLen it's not filled at all
  pressureCurve.style['stroke-dashoffset'] = pressureCurveLen - (pressureCurveLen * percPos);

}

document.reset = function() {
  initialized = false;
  for(var k = 1; k &lt; dashCount + 3; k++) {
    document.getElementById('pressuretext' + k).style['visibility'] = 'hidden';
  }
}

document.isStreamValid = function (streams) {return !!streams.forcedInductionInfo;};

document.update = function(streams) {
  var streamData = streams.forcedInductionInfo;
  // real data mode, no animation

  pressure_max = Math.ceil(UnitPressure(Math.max(PRESURE_MAX_CONST, streamData.maxBoost)));
  pressure_min = Math.floor(UnitPressure(PRESURE_MIN_CONST));

  if(!initialized) {

    document.reset();

    var redline_perc = 0.8; //TODO: should make this calculated with engine damage that can make the turbo

    redLine.style['stroke-dasharray'] = redLineLen + ' ' + redLineLen;
    redLine.style['stroke-dashoffset'] = -redline_perc * redLineLen;


    var dashes = (pressureCurveDashesLen - dashSize * dashCount) / (dashCount + 1);
    pressureCurveDashes.style['stroke-dasharray'] = dashSize + ' ' + dashes;
    pressureCurveDashes.style['stroke-dashoffset'] = dashSize;

    // setup and move the pressure gauge text

    var lastT = 0;
    for(var k = 0 ; k &lt; dashCount + 2; k++) {
      var pos = pressureTextGuideLine.getPointAtLength(pressureTextGuideLineLen * (k / (dashCount + 1)));
      var rp = document.getElementById('pressuretext' + (k + 1) + 'p');
      var cx = rp.getAttribute('x');
      var cy = rp.getAttribute('y');
      rp.setAttribute('transform','translate(' + (pos.x - cx) + ',' + (pos.y - cy ) + ')');
      document.getElementById('pressuretext' + (k + 1)).textContent = document.roundDec(k * ((pressure_max - pressure_min) / (dashCount + 1)) + pressure_min, (pressure_max &gt; 10 ? 0 : 1));
      document.getElementById('pressuretext' + (k + 1)).style['visibility'] = 'visible';
    }
    initialized = true;
  }

  // if(streams.forcedInductionInfo.boost &lt; 0 &amp;&amp; unitSystem != &quot;metric&quot;)
  // {
  //   //psi to in.HG when pressure is vaccum
  //   data.psi = (streams.forcedInductionInfo.boost * 2.03) / (30 * 2);
  //   data.pressureText = streams.forcedInductionInfo.boost * 2.03;
  // }
  // else
  // {
  //   data.pressureText = streams.forcedInductionInfo.boost * pressureunitMultiplier;
  //   data.psi = streams.forcedInductionInfo.boost / pressure_max;
  // }

  applyData(streamData);
}

var UiUnitscallback;

function UnitPressure (val) {
  var convertedVal = UiUnitscallback(val, 'pressure');

  if (pressureunitText.textContent !== convertedVal.unit) {
    pressureunitText.textContent = convertedVal.unit;
    // the scala needs to be changed
    initialized = false;
  }

  return convertedVal.val;
}

document.roundDec = () =&gt; 0;

document.wireThroughUnitSystem = function (callback) {
  UiUnitscallback = callback;
};
  </script></svg>
